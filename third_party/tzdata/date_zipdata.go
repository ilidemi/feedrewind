// Copyright 2020 The Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

//go:build ignore

// This program generates zipdata.go from $GOROOT/lib/time/zoneinfo.zip.
package main

import (
	"fmt"
	"os"
)

func main() {
	zzipDataFileInfo, err := os.Stat("third_party/tzdata/zzipdata.go")
	if err != nil {
		die("%v", err)
	}
	zzipDataModDate := zzipDataFileInfo.ModTime().Format("2006-01-02")
	updatedDateContents := fmt.Sprintf(
		"// Code generated by date_zipdata. DO NOT EDIT.\n\npackage tzdata\n\nconst UpdatedDate = %q\n",
		zzipDataModDate,
	)
	err = os.WriteFile("third_party/tzdata/updated_date.go", []byte(updatedDateContents), 0666)
	if err != nil {
		die("error writing to updated_date.go: %v", err)
	}
}

func die(format string, args ...any) {
	fmt.Fprintf(os.Stderr, format+"\n", args...)
	os.Exit(1)
}
